{"version":3,"file":"authSwitch.js","sources":["store/authSwitch.js"],"sourcesContent":["import { defineStore } from 'pinia';\r\nimport { ref, watch } from 'vue';\r\n\r\nexport const useAuthSwitchStore = defineStore( 'auth', ( ) => {\r\n\tconst authSwitch = ref( false )\r\n\t\r\n\t// 初始化时从本地存储加载状态\r\n\ttry {\r\n\t\tconst savedState = uni.getStorageSync('auth-state')\r\n\t\tif (savedState !== '') {\r\n\t\t\tauthSwitch.value = JSON.parse(savedState)\r\n\t\t\tconsole.log('从存储加载权限状态:', authSwitch.value)\r\n\t\t}\r\n\t} catch (e) {\r\n\t\tconsole.error('加载权限状态失败:', e)\r\n\t}\r\n\t\r\n\t// 监听状态变化并保存到本地存储\r\n\twatch(authSwitch, (newValue) => {\r\n\t\ttry {\r\n\t\t\tuni.setStorageSync('auth-state', JSON.stringify(newValue))\r\n\t\t\tconsole.log('权限状态已保存到存储:', newValue)\r\n\t\t} catch (e) {\r\n\t\t\tconsole.error('保存权限状态失败:', e)\r\n\t\t}\r\n\t})\r\n\r\n\tconst setAuthValue = ( v ) => {\r\n\t\tauthSwitch.value = v\r\n\t}\r\n\r\n\tconst setAuth = ( ) => {\r\n\t\tauthSwitch.value = !authSwitch.value\r\n\t}\r\n\r\n\treturn {\r\n\t\tauthSwitch,\r\n\t\tsetAuthValue,\r\n\t\tsetAuth\r\n\t}\r\n}, {\r\n\tpersist: {\r\n\t\t// 使用 uni storage 代替 localStorage\r\n\t\tstorage: {\r\n\t\t\tgetItem( key ) {\r\n\t\t\t\treturn uni.getStorageSync( key )\r\n\t\t\t},\r\n\t\t\tsetItem( key, value ) {\r\n\t\t\t\tuni.setStorageSync( key, value )\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n} )"],"names":["defineStore","ref","uni","watch"],"mappings":";;AAGY,MAAC,qBAAqBA,cAAAA,YAAa,QAAQ,MAAO;AAC7D,QAAM,aAAaC,cAAG,IAAE,KAAO;AAG/B,MAAI;AACH,UAAM,aAAaC,cAAAA,MAAI,eAAe,YAAY;AAClD,QAAI,eAAe,IAAI;AACtB,iBAAW,QAAQ,KAAK,MAAM,UAAU;AACxCA,oBAAY,MAAA,MAAA,OAAA,6BAAA,cAAc,WAAW,KAAK;AAAA,IAC1C;AAAA,EACD,SAAQ,GAAG;AACXA,kBAAAA,MAAc,MAAA,SAAA,6BAAA,aAAa,CAAC;AAAA,EAC5B;AAGDC,sBAAM,YAAY,CAAC,aAAa;AAC/B,QAAI;AACHD,oBAAG,MAAC,eAAe,cAAc,KAAK,UAAU,QAAQ,CAAC;AACzDA,oBAAAA,MAAA,MAAA,OAAA,6BAAY,eAAe,QAAQ;AAAA,IACnC,SAAQ,GAAG;AACXA,oBAAAA,MAAA,MAAA,SAAA,6BAAc,aAAa,CAAC;AAAA,IAC5B;AAAA,EACH,CAAE;AAED,QAAM,eAAe,CAAE,MAAO;AAC7B,eAAW,QAAQ;AAAA,EACnB;AAED,QAAM,UAAU,MAAO;AACtB,eAAW,QAAQ,CAAC,WAAW;AAAA,EAC/B;AAED,SAAO;AAAA,IACN;AAAA,IACA;AAAA,IACA;AAAA,EACA;AACF,GAAG;AAAA,EACF,SAAS;AAAA;AAAA,IAER,SAAS;AAAA,MACR,QAAS,KAAM;AACd,eAAOA,cAAG,MAAC,eAAgB,GAAK;AAAA,MAChC;AAAA,MACD,QAAS,KAAK,OAAQ;AACrBA,4BAAI,eAAgB,KAAK,KAAO;AAAA,MAChC;AAAA,IACD;AAAA,EACD;AACF,CAAC;;"}