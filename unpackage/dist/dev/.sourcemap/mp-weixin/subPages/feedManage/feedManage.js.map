{"version":3,"file":"feedManage.js","sources":["subPages/feedManage/feedManage.vue","../../软件/HBuilderX/HBuilderX/plugins/uniapp-cli-vite/uniPage:/c3ViUGFnZXNcZmVlZE1hbmFnZVxmZWVkTWFuYWdlLnZ1ZQ"],"sourcesContent":["<script setup>\n\timport { ref, onMounted } from 'vue'\n\timport formatTime from '@/utils/formatTime.js'\n\n\t// 反馈列表数据\n\tconst feedbackList = ref( [ ] )\n\t// 加载状态\n\tconst loading = ref( true )\n\n\t// 获取反馈列表\n\tconst getFeedbackList = async ( ) => {\n\t\ttry {\n\t\t\tconst feedbackApi = uniCloud.importObject( 'feedback', { customUI: true } )\n\t\t\tconst res = await feedbackApi.getList( )\n\n\t\t\tif ( res.success ) {\n\t\t\t\tfeedbackList.value = res.data\n\t\t\t}\n\t\t} catch ( err ) {\n\t\t\tuni.showToast( {\n\t\t\t\ttitle: err.message || '加载失败',\n\t\t\t\ticon: 'none'\n\t\t\t} )\n\t\t} finally {\n\t\t\tloading.value = false\n\t\t}\n\t}\n\n\t// 删除反馈\n\tconst handleDelete = ( id ) => {\n\t\tuni.showModal( {\n\t\t\ttitle: '提示',\n\t\t\tcontent: '确定要删除这条反馈吗？',\n\t\t\tasync success( res ) {\n\t\t\t\tif ( res.confirm ) {\n\t\t\t\t\ttry {\n\t\t\t\t\t\tconst feedbackApi = uniCloud.importObject( 'feedback', { customUI: true } )\n\t\t\t\t\t\tconst res = await feedbackApi.remove( id )\n\t\t\t\t\t\tif ( res.success ) {\n\t\t\t\t\t\t\tuni.showToast( {\n\t\t\t\t\t\t\t\ttitle: '删除成功',\n\t\t\t\t\t\t\t\ticon: 'success'\n\t\t\t\t\t\t\t} )\n\t\t\t\t\t\t\t// 重新加载数据\n\t\t\t\t\t\t\tgetFeedbackList( )\n\t\t\t\t\t\t}\n\t\t\t\t\t} catch ( err ) {\n\t\t\t\t\t\tuni.showToast( {\n\t\t\t\t\t\t\ttitle: err.message || '删除失败',\n\t\t\t\t\t\t\ticon: 'none'\n\t\t\t\t\t\t} )\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t} )\n\t}\n\n\t// 预览图片\n\tconst previewImage = ( urls, current ) => {\n\t\tuni.previewImage( {\n\t\t\turls,\n\t\t\tcurrent\n\t\t} )\n\t}\n\n\t// 生命周期\n\tonMounted( ( ) => {\n\t\tgetFeedbackList( )\n\t} )\n</script>\n\n<template>\n\t<view class=\"feedback-manage\">\n\t\t<!-- 加载状态 -->\n\t\t<up-loading-page :loading=\"loading && !feedbackList.length\"></up-loading-page>\n\n\t\t<!-- 反馈列表 -->\n\t\t<view class=\"feedback-list\" v-if=\"feedbackList.length\">\n\t\t\t<view class=\"feedback-item\" v-for=\"item in feedbackList\" :key=\"item._id\">\n\t\t\t\t<!-- 头部信息 -->\n\t\t\t\t<view class=\"item-header\">\n\t\t\t\t\t<view class=\"left\">\n\t\t\t\t\t\t<text class=\"type\">{{ item.type }}</text>\n\t\t\t\t\t\t<text class=\"time\">{{ formatTime(item.create_time) }}</text>\n\t\t\t\t\t</view>\n\t\t\t\t\t<view class=\"right\">\n\t\t\t\t\t\t<button class=\"delete-btn\" size=\"mini\" @click=\"handleDelete(item._id)\">删除</button>\n\t\t\t\t\t</view>\n\t\t\t\t</view>\n\n\t\t\t\t<!-- 内容区域 -->\n\t\t\t\t<view class=\"item-content\">\n\t\t\t\t\t<text class=\"content-text\">{{ item.content }}</text>\n\n\t\t\t\t\t<!-- 图片区域 -->\n\t\t\t\t\t<view class=\"image-list\" v-if=\"item.images && item.images.length\">\n\t\t\t\t\t\t<image v-for=\"(img, index) in item.images\" :key=\"index\" :src=\"img.url\" mode=\"aspectFill\"\n\t\t\t\t\t\t\t@click=\"previewImage(item.images.map(i => i.url), img.url)\"></image>\n\t\t\t\t\t</view>\n\t\t\t\t</view>\n\n\t\t\t\t<!-- 联系方式 -->\n\t\t\t\t<view class=\"item-footer\" v-if=\"item.contact\">\n\t\t\t\t\t<text class=\"contact\">联系方式：{{ item.contact }}</text>\n\t\t\t\t</view>\n\t\t\t</view>\n\t\t</view>\n\n\t\t<!-- 空状态 -->\n\t\t<view class=\"empty\" v-else-if=\"!loading\">\n\t\t\t<text>暂无反馈数据</text>\n\t\t</view>\n\t</view>\n</template>\n\n<style lang=\"scss\" scoped>\n\t.feedback-manage {\n\t\tmin-height: 100vh;\n\t\tbackground-color: #f5f7fa;\n\t\tpadding: 24rpx;\n\t}\n\n\t.feedback-list {\n\t\t.feedback-item {\n\t\t\tbackground-color: #fff;\n\t\t\tborder-radius: 16rpx;\n\t\t\tpadding: 32rpx;\n\t\t\tmargin-bottom: 24rpx;\n\n\t\t\t.item-header {\n\t\t\t\tdisplay: flex;\n\t\t\t\tjustify-content: space-between;\n\t\t\t\talign-items: center;\n\t\t\t\tmargin-bottom: 24rpx;\n\n\t\t\t\t.left {\n\t\t\t\t\t.type {\n\t\t\t\t\t\tfont-size: 28rpx;\n\t\t\t\t\t\tcolor: $pyq-vi-color;\n\t\t\t\t\t\tmargin-right: 16rpx;\n\t\t\t\t\t}\n\n\t\t\t\t\t.time {\n\t\t\t\t\t\tfont-size: 24rpx;\n\t\t\t\t\t\tcolor: $pyq-text-color-helper;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t.delete-btn {\n\t\t\t\t\tfont-size: 24rpx;\n\t\t\t\t\tcolor: $pyq-text-color-error;\n\t\t\t\t\tbackground: none;\n\t\t\t\t\tpadding: 8rpx 24rpx;\n\n\t\t\t\t\t&::after {\n\t\t\t\t\t\tborder: none;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t.item-content {\n\t\t\t\t.content-text {\n\t\t\t\t\tfont-size: 28rpx;\n\t\t\t\t\tcolor: $pyq-text-color-body;\n\t\t\t\t\tline-height: 1.6;\n\t\t\t\t}\n\n\t\t\t\t.image-list {\n\t\t\t\t\tdisplay: flex;\n\t\t\t\t\tflex-wrap: wrap;\n\t\t\t\t\tgap: 16rpx;\n\t\t\t\t\tmargin-top: 24rpx;\n\n\t\t\t\t\timage {\n\t\t\t\t\t\twidth: 180rpx;\n\t\t\t\t\t\theight: 180rpx;\n\t\t\t\t\t\tborder-radius: 8rpx;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t.item-footer {\n\t\t\t\tmargin-top: 24rpx;\n\t\t\t\tpadding-top: 24rpx;\n\t\t\t\tborder-top: 2rpx solid $pyq-text-color-placeholder;\n\n\t\t\t\t.contact {\n\t\t\t\t\tfont-size: 24rpx;\n\t\t\t\t\tcolor: $pyq-text-color-helper;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\t.empty {\n\t\ttext-align: center;\n\t\tpadding: 48rpx;\n\t\tcolor: $pyq-text-color-helper;\n\t\tfont-size: 28rpx;\n\t}\n</style>","import MiniProgramPage from 'D:/代码测试/wx2/subPages/feedManage/feedManage.vue'\nwx.createPage(MiniProgramPage)"],"names":["ref","uniCloud","uni","res","onMounted"],"mappings":";;;;;;;;;;AAKC,UAAM,eAAeA,cAAG,IAAE,EAAK;AAE/B,UAAM,UAAUA,cAAG,IAAE,IAAM;AAG3B,UAAM,kBAAkB,YAAa;AACpC,UAAI;AACH,cAAM,cAAcC,cAAAA,GAAS,aAAc,YAAY,EAAE,UAAU,MAAQ;AAC3E,cAAM,MAAM,MAAM,YAAY,QAAU;AAExC,YAAK,IAAI,SAAU;AAClB,uBAAa,QAAQ,IAAI;AAAA,QACzB;AAAA,MACD,SAAS,KAAM;AACfC,sBAAAA,MAAI,UAAW;AAAA,UACd,OAAO,IAAI,WAAW;AAAA,UACtB,MAAM;AAAA,QACV,CAAM;AAAA,MACN,UAAY;AACT,gBAAQ,QAAQ;AAAA,MAChB;AAAA,IACD;AAGD,UAAM,eAAe,CAAE,OAAQ;AAC9BA,oBAAAA,MAAI,UAAW;AAAA,QACd,OAAO;AAAA,QACP,SAAS;AAAA,QACT,MAAM,QAAS,KAAM;AACpB,cAAK,IAAI,SAAU;AAClB,gBAAI;AACH,oBAAM,cAAcD,cAAAA,GAAS,aAAc,YAAY,EAAE,UAAU,MAAQ;AAC3E,oBAAME,OAAM,MAAM,YAAY,OAAQ,EAAI;AAC1C,kBAAKA,KAAI,SAAU;AAClBD,8BAAAA,MAAI,UAAW;AAAA,kBACd,OAAO;AAAA,kBACP,MAAM;AAAA,gBACd,CAAU;AAEH,gCAAkB;AAAA,cAClB;AAAA,YACD,SAAS,KAAM;AACfA,4BAAAA,MAAI,UAAW;AAAA,gBACd,OAAO,IAAI,WAAW;AAAA,gBACtB,MAAM;AAAA,cACb,CAAS;AAAA,YACH;AAAA,UACD;AAAA,QACD;AAAA,MACJ,CAAK;AAAA,IACH;AAGD,UAAM,eAAe,CAAE,MAAM,YAAa;AACzCA,oBAAAA,MAAI,aAAc;AAAA,QACjB;AAAA,QACA;AAAA,MACH,CAAK;AAAA,IACH;AAGDE,kBAAAA,UAAW,MAAO;AACjB,sBAAkB;AAAA,IACpB,CAAI;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACnEJ,GAAG,WAAW,eAAe;"}