"use strict";const e=require("../../common/vendor.js");if(!Array){e.resolveComponent("uni-icons")()}Math;const a={__name:"video-preview",setup(a){const l=e.ref(""),o=e.ref(""),t=e.ref(0),u=e.ref(0),r=e.ref(0),v=e.ref(0),n=e.ref(null),i=e.ref(!1),d=e.ref(0),s=e.ref(!0),c=e.ref(null),p=e=>{const a=Math.floor(e/60),l=Math.floor(e%60);return`${a.toString().padStart(2,"0")}:${l.toString().padStart(2,"0")}`},f=e.computed((()=>p(t.value))),m=e.computed((()=>p(d.value))),h=e.computed((()=>{return(e=u.value)<1024?e+"B":e<1048576?(e/1024).toFixed(2)+"KB":e<1073741824?(e/1048576).toFixed(2)+"MB":(e/1073741824).toFixed(2)+"GB";var e})),g=e.computed((()=>`${r.value}x${v.value}`));e.onMounted((()=>{getOpenerEventChannel();const a=getCurrentPages(),i=a[a.length-1].options||{};console.log("视频预览页面参数:",i),i.videoUrl&&(l.value=decodeURIComponent(i.videoUrl),console.log("视频URL:",l.value)),i.thumbnailUrl&&(o.value=decodeURIComponent(i.thumbnailUrl)),i.duration&&(t.value=parseInt(i.duration)||0),i.size&&(u.value=parseInt(i.size)||0),i.width&&(r.value=parseInt(i.width)||0),i.height&&(v.value=parseInt(i.height)||0),n.value=e.index.createVideoContext("myVideo"),C()})),e.onUnmounted((()=>{n.value&&n.value.pause(),c.value&&clearTimeout(c.value)}));const x=()=>{e.index.navigateBack()},U=()=>{i.value?n.value.pause():n.value.play(),i.value=!i.value,s.value=!0,C()},w=()=>{i.value=!0},y=()=>{i.value=!1},I=e=>{d.value=e.detail.currentTime},b=()=>{s.value=!s.value,s.value&&C()},C=()=>{c.value&&clearTimeout(c.value),c.value=setTimeout((()=>{i.value&&(s.value=!1)}),3e3)},_=()=>{n.value.requestFullScreen({direction:0})},z=a=>{console.error("视频加载错误:",a),e.index.showToast({title:"视频加载失败",icon:"none"})};return(a,t)=>e.e({a:s.value},s.value?{b:e.p({type:"back",size:"24",color:"#fff"}),c:e.o(x)}:{},{d:l.value,e:o.value,f:e.o(w),g:e.o(y),h:e.o(I),i:e.o(z),j:s.value},s.value?{k:e.p({type:i.value?"pause-filled":"play-filled",size:"50",color:"#fff"}),l:e.o(U),m:e.t(m.value),n:e.t(f.value),o:e.p({type:"arrow-right",size:"24",color:"#fff"}),p:e.o(_)}:{},{q:s.value},s.value?{r:e.t(f.value),s:e.t(h.value),t:e.t(g.value)}:{},{v:e.o(b),w:e.gei(a,"")})}},l=e._export_sfc(a,[["__scopeId","data-v-d0136bb0"]]);wx.createPage(l);
