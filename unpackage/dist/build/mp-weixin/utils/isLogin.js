"use strict";const o=require("../common/vendor.js"),e=require("../store/user.js");exports.testLogin=()=>{const n=e.useUserInfoStore();if(console.log("检查登录状态 - store中的用户信息:",n.userInfo),n.userInfo&&n.userInfo.uid)return console.log("用户已在store中登录，UID:",n.userInfo.uid),!0;const s=o.index.getStorageSync("userInfo");return console.log("检查登录状态 - 本地存储中的用户信息:",s),s&&s.uid?(console.log("从本地存储中找到用户信息，正在更新store"),n.setUserInfo(s),!0):(o.index.showModal({title:"提示",content:"请登录后继续",confirmColor:"#399bfe",confirmText:"去登录",success:e=>{if(e.confirm){const e=getCurrentPages(),n=e[e.length-1],s=n.route,r=n.options||{};let t="/"+s;const i=[];for(const o in r)r.hasOwnProperty(o)&&i.push(`${o}=${encodeURIComponent(r[o])}`);i.length>0&&(t+="?"+i.join("&")),o.index.navigateTo({url:`/pages/login/login?redirect=${encodeURIComponent(t)}`})}}}),!1)};
