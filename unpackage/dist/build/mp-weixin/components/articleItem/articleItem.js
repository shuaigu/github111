"use strict";const e=require("../../common/vendor.js"),t=require("../../store/user.js");if(!Array){e.resolveComponent("uni-icons")()}Math;const i={__name:"articleItem",props:{item:{type:Object,require:!0,default:()=>({user_info:{nickName:"未知用户",avatarUrl:"/static/images/default-avatar.png",mobile:"未填写"}})},showComments:{type:Boolean,default:!1},avatarClickEnabled:{type:Boolean,default:!0}},emits:["delete","contact","comment","like","preview","userList","update:comments"],setup(i,{emit:a}){const r=t.useUserInfoStore(),o=i,n=e=>{if(!e)return"未知时间";const t=Date.now()-e,i=Math.floor(t/1e3),a=Math.floor(i/60),r=Math.floor(a/60),o=Math.floor(r/24);if(i<60)return"刚刚";if(a<60)return`${a}分钟前`;if(r<24)return`${r}小时前`;if(o<180)return`${o}天前`;{const t=new Date(e),i=t.getFullYear(),a=t.getMonth()+1,r=t.getDate(),o=t.getHours(),n=t.getMinutes(),s=a<10?`0${a}`:a,m=r<10?`0${r}`:r,l=`${o<10?`0${o}`:o}:${n<10?`0${n}`:n}`;return i===(new Date).getFullYear()?`${s}月${m}日 ${l}`:`${i}年${s}月${m}日 ${l}`}},s=a,m=t=>{o.showComments||e.index.navigateTo({url:`/pages/article/articleDetail?article_id=${t._id}&user_id=${t.user_id}`,animationType:"slide-in-right",animationDuration:300})},l=e.computed((()=>o.item||{nickName:"未知用户",avatarUrl:"/static/images/default-avatar.png",mobile:"未填写"})),u=e=>{e.target.src="/static/images/default-avatar.png"},c=(e,t)=>{if(!e)return;console.log("Original URL:",e);const i=o.item.images.filter((e=>e.thumbnailURL||e.compressedURL||e.url)).slice(0,9);if(i.length){const e=i.map((e=>e.compressedURL||e.thumbnailURL||e.url));s("preview",e[t],e)}};return(t,a)=>{var d,g,p,v;return e.e({a:l.value.user_avatarUrl,b:e.o(u),c:e.t(l.value.user_nickName),d:e.p({"custom-prefix":"icon",type:"lishuai-dingwei",size:"12",color:"#8a8a8a"}),e:e.t(i.item.district||"未知位置"),f:e.t(n(i.item.create_time)),g:e.o((t=>(t=>{if(!o.avatarClickEnabled)return console.log("头像点击功能已禁用"),void e.index.showToast({title:"此功能开发中",icon:"none",duration:2e3});s("userList",t)})(i.item.user_id))),h:i.avatarClickEnabled?"":1,i:i.item.user_id===e.unref(r).userInfo.uid},i.item.user_id===e.unref(r).userInfo.uid?{j:e.p({color:"#999999","custom-prefix":"icon",type:"lishuai-shanchu",size:"18"}),k:e.o((e=>{return t=i.item._id,void s("delete",t);var t}))}:{l:e.p({color:"#5cb85c","custom-prefix":"icon",type:"lishuai-dianhua",size:"18"}),m:e.o((e=>{return t=i.item.user_mobile,void s("contact",t);var t}))},{n:e.t(i.item.content),o:e.o((e=>m(i.item))),p:null==(d=i.item.images)?void 0:d.length},(null==(g=i.item.images)?void 0:g.length)?e.e({q:1===i.item.images.length},1===i.item.images.length?{r:i.item.images[0].compressedURL||i.item.images[0].thumbnailURL||i.item.images[0].url,s:e.o((e=>m(i.item))),t:e.o((()=>c(i.item.images[0].compressedURL||i.item.images[0].thumbnailURL||i.item.images[0].url,0)))}:{v:e.f(i.item.images.slice(0,9),((t,a,r)=>({a:a,b:t.compressedURL||t.thumbnailURL||t.url,c:e.o((e=>m(i.item)),a),d:e.o((()=>c(t.compressedURL||t.thumbnailURL||t.url,a)),a)}))),w:e.n(`grid-${Math.min(i.item.images.length,9)}`)}):{},{x:i.item.videoURL||(null==(p=i.item.video)?void 0:p.videoURL)},i.item.videoURL||(null==(v=i.item.video)?void 0:v.videoURL)?{y:e.p({"custom-prefix":"icon",type:"lishuai-shipin",size:"14",color:"#999999"})}:{},{z:e.t(i.item.look_count||0),A:e.gei(t,"")})}}},a=e._export_sfc(i,[["__scopeId","data-v-222e4310"]]);wx.createComponent(a);
