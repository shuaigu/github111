"use strict";const e=require("../../common/vendor.js"),o=require("../../store/user.js"),t=require("../../utils/formatTime.js");if(!Array){e.resolveComponent("uni-icons")()}Math;const r={__name:"comment-list",props:{comments:{type:Array,default:()=>[]},articleId:{type:String,default:""},articleUserId:{type:String,default:""},showMobile:{type:Boolean,default:!1}},emits:["update:comments","reply","delComment"],setup(r,{emit:n}){const i=o.useUserInfoStore(),s=r,a=n,l=e=>e.user_id===i.userInfo.uid,m=()=>!(!i.userInfo||!i.userInfo.uid)&&(!!s.articleUserId&&i.userInfo.uid===s.articleUserId),c=e=>{if(!e||e.length<7)return e;if(11===e.length)return e.substring(0,3)+"****"+e.substring(7);const o=Math.floor(e.length/3),t=e.length-o;return e.substring(0,o)+"****"+e.substring(t)};return(o,n)=>e.e({},{d:e.f(r.comments,((o,n,i)=>e.e({a:o.avatarUrl,b:e.t(o.nickName),c:r.showMobile&&o.mobile&&m()},r.showMobile&&o.mobile&&m()?{d:"19ed4ace-0-"+i,e:e.p({type:"phone",size:"11",color:"#399bfe"}),f:e.t(c(o.mobile)),g:e.o((t=>{return r=o.mobile,void(m()&&e.index.showModal({title:"拨打电话",content:`确定要拨打 ${r} 吗？`,success:o=>{o.confirm&&e.index.makePhoneCall({phoneNumber:r,fail:o=>{e.index.showToast({title:"拨打电话失败",icon:"none"})}})}}));var r}),n)}:{},{h:l(o)},l(o)?{i:"19ed4ace-1-"+i,j:e.p({"custom-prefix":"iconfont",type:"icon-shanchu1",size:"16",color:"#999"}),k:e.o((e=>{return t=o._id,void a("delComment",t);var t}),n)}:{},{l:o.reply_to},o.reply_to?{m:e.t(o.reply_to.nickName)}:{},{n:o.content},o.content?{o:e.t(o.content)}:{},{p:o.imageUrl&&(!o.images||0===o.images.length)},!o.imageUrl||o.images&&0!==o.images.length?{}:{q:o.imageUrl,r:e.o((t=>{var r;(r=o.imageUrl)&&e.index.previewImage({current:r,urls:[r],indicator:"number",loop:!0,fail:o=>{console.error("预览图片失败:",o),e.index.showToast({title:"预览图片失败",icon:"none"})}})}),n)},{s:o.images&&o.images.length>0},o.images&&o.images.length>0?{t:e.f(o.images,((t,r,n)=>({a:t,b:r,c:e.o((t=>{return n=o.images,i=r,void(n&&0!==n.length&&e.index.previewImage({current:n[i],urls:n,indicator:"number",loop:!0,fail:o=>{console.error("预览图片失败:",o),e.index.showToast({title:"预览图片失败",icon:"none"})}}));var n,i}),r)})))}:{},{v:e.t(e.unref(t.formatTime)(o.create_time)),w:e.o((e=>(e=>{console.log(e),l(e)||a("reply",e)})(o)),n),x:l(o)?1:"",y:n}))),e:e.gei(o,"")})}},n=e._export_sfc(r,[["__scopeId","data-v-19ed4ace"]]);wx.createComponent(n);
